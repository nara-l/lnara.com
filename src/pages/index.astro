---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import getSortedPosts from "@/utils/getSortedPosts";
import { getPath } from "@/utils/getPath";
import { SITE } from "@/config";

const posts = await getCollection("blog");
const sortedPosts = getSortedPosts(posts);
const recentPosts = sortedPosts.slice(0, 5); // Last 5 posts
---

<Layout>
  <Header />
  <main id="main-content" class="max-w-3xl mx-auto px-4 py-8">

    <!-- Header -->
    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-2">Lawrence Nara</h1>
      <p class="text-lg text-gray-600">Building stuff, thinking out loud</p>
    </header>

    <hr class="my-8 border-gray-300" />

    <!-- Now Section -->
    <section class="mb-12">
      <h2 class="text-xl font-semibold mb-4">Now</h2>
      <p class="text-gray-700 leading-relaxed">
        Currently working on migrating my blog to a cleaner, more focused format.
        Experimenting with simplicity and authentic content over complexity.
      </p>
      <p class="text-sm text-gray-500 mt-2">Last updated: January 2025</p>
    </section>

    <hr class="my-8 border-gray-300" />

    <!-- Recent Writing -->
    <section class="mb-12">
      <h2 class="text-xl font-semibold mb-6">Recent Writing</h2>
      <ul class="space-y-4">
        {recentPosts.map((post) => (
          <li>
            <a
              href={getPath(post.id, post.filePath)}
              class="block hover:text-blue-600 transition-colors"
            >
              <div class="flex flex-col sm:flex-row sm:items-baseline sm:justify-between">
                <h3 class="font-medium">{post.data.title}</h3>
                <time class="text-sm text-gray-500 mt-1 sm:mt-0">
                  {post.data.pubDatetime.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                  })}
                </time>
              </div>
              <p class="text-gray-600 text-sm mt-1 line-clamp-1">
                {post.data.description}
              </p>
            </a>
          </li>
        ))}
      </ul>
      <div class="mt-6">
        <a
          href="/posts/"
          class="text-blue-600 hover:underline text-sm"
        >
          → View all posts
        </a>
      </div>
    </section>

    <hr class="my-8 border-gray-300" />

    <!-- Work Section -->
    <section class="mb-12">
      <h2 class="text-xl font-semibold mb-6">Work</h2>
      <ul class="space-y-3">
        <li>
          <strong>AfroVision Group</strong> - Built web applications and CMS solutions using Kohana framework for African market
        </li>
        <li>
          <strong>Various Projects</strong> - Developed MVC applications, database solutions, and helped teams embrace modern development practices
        </li>
      </ul>
      <div class="mt-6">
        <a
          href="/cv.pdf"
          class="text-blue-600 hover:underline text-sm"
        >
          Want the formal version? Download PDF
        </a>
      </div>
    </section>

    <hr class="my-8 border-gray-300" />

    <!-- Connect Section -->
    <section class="mb-12">
      <h2 class="text-xl font-semibold mb-6">Connect</h2>
      <div class="flex gap-4">
        <a
          href="mailto:admin@lnara.com"
          class="text-blue-600 hover:underline"
        >
          Email
        </a>
        <span class="text-gray-400">·</span>
        <a
          href="https://x.com/lawrencenara"
          class="text-blue-600 hover:underline"
          target="_blank"
          rel="noopener noreferrer"
        >
          X
        </a>
        <span class="text-gray-400">·</span>
        <a
          href="/rss.xml"
          class="text-blue-600 hover:underline"
        >
          RSS
        </a>
      </div>
    </section>

  </main>
  <Footer />
</Layout>

<style>
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>